#===============================================================================
# PAQET MIDDLE VPS — DaaS Edition (Docker Compose)
#
# Traffic chain:
#   Your Device (Shadowrocket) → This VPS (VLESS) → Server VPS (paqet)
#
# INSTRUCTIONS:
#   1. Change SERVER_IP, SERVER_PORT, SECRET_KEY, DAAS_DOMAIN below
#   2. Paste this file into your DaaS provider
#   3. After startup, check container logs for your VLESS config
#
# Uses pre-built image — no apt-get, no downloads, instant startup!
#===============================================================================

services:
  paqet-middle:
    image: ghcr.io/heidarimilad/paqet-middle:latest
    container_name: paqet-middle
    restart: unless-stopped
    privileged: true
    cap_add:
      - NET_ADMIN
      - NET_RAW
    ports:
      - "443:443"
    environment:
      # ═══════════════════════════════════════════════════════════════════
      #  REQUIRED — Change these
      # ═══════════════════════════════════════════════════════════════════
      - SERVER_IP=CHANGE_ME                        # ← Your paqet server IP
      - SERVER_PORT=9999                           # ← Your paqet server port
      - SECRET_KEY=CHANGE_ME                       # ← Your paqet secret key
      - DAAS_DOMAIN=CHANGE_ME                      # ← Your DaaS domain (e.g. xxx.darkube.app)
      # ═══════════════════════════════════════════════════════════════════
      #  Optional — defaults work fine
      # ═══════════════════════════════════════════════════════════════════
      - REALITY_TRANSPORT=tcp                      # tcp (Reality) or ws (WebSocket)
      - REALITY_PORT=443
      - DAAS_PORT=443                              # External port of your domain
      - REALITY_SNI=www.google.com
      - INITIAL_USER=default
      - PAQET_VERSION=v1.0.0-alpha.14
    volumes:
      - paqet-data:/opt/data
    logging:
      driver: json-file
      options:
        max-size: 10m
        max-file: "3"

volumes:
  paqet-data:
